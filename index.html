<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="public, max-age=3600">
    <title>你的曼德雷常驻民画像</title>
    
    <!-- 多CDN源预加载 -->
    <link rel="preload" href="https://cdn.bootcdn.net/ajax/libs/normalize/8.0.1/normalize.min.css" as="style">
    <link rel="preload" href="styles.css" as="style">
    <link rel="preload" href="script.js" as="script">
    
    <!-- 主样式表加载，带多级回退 -->
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/normalize/8.0.1/normalize.min.css">
    <link rel="stylesheet" href="styles.css" onerror="loadFallbackCSS()">
    
    <script>
        // 多级回退CSS加载
        function loadFallbackCSS() {
            const fallbackSources = [
                'https://cdn.jsdelivr.net/gh/juliengogh/manderley@main/styles.css',
                'https://cdn.bootcdn.net/ajax/libs/normalize/8.0.1/normalize.min.css'
            ];
            
            let loaded = false;
            fallbackSources.forEach(src => {
                if (!loaded) {
                    const link = document.createElement('link');
                    link.rel = 'stylesheet';
                    link.href = src;
                    link.onload = () => loaded = true;
                    document.head.appendChild(link);
                }
            });
        }
        
        // 资源加载状态检测
        function checkResourcesLoaded() {
            const loadingElement = document.getElementById('loading');
            if (loadingElement) {
                loadingElement.style.display = 'none';
            }
            
            // 检查CSS是否加载成功
            if (!document.querySelector('link[href*="styles.css"]') && 
                !document.querySelector('link[href*="normalize"]')) {
                loadFallbackCSS();
            }
        }
        
        // 主加载完成事件
        window.addEventListener('load', checkResourcesLoaded);
        
        // 超时处理
        setTimeout(function() {
            const loadingElement = document.getElementById('loading');
            if (loadingElement && loadingElement.style.display !== 'none') {
                loadingElement.innerHTML = 
                    '<div style="color:#fff;text-align:center;padding:20px;">' +
                    '   <p>加载遇到问题，请尝试：</p>' +
                    '   <p>1. 切换网络(WiFi/4G/5G)</p>' +
                    '   <p>2. 稍后再试</p>' +
                    '   <button onclick="window.location.reload()" style="padding:10px 20px;margin-top:20px;background:#007bff;color:#fff;border:none;border-radius:5px;">重新加载</button>' +
                    '</div>';
            }
        }, 5000);
    </script>
</head>
<body>
    <!-- 加载指示器 -->
    <div id="loading" style="position:fixed;top:0;left:0;width:100%;height:100%;background:#000;z-index:9999;display:flex;justify-content:center;align-items:center;">
        <div style="color:#fff;font-size:20px;">加载中...</div>
    </div>
    
    <div id="quiz-container">
        <h1>你的曼德雷常驻民画像</h1>
        
        <!-- 新增的描述文字 -->
        <p class="description">
            《不眠之夜》新生相见，曼德雷酒吧也特别上新了多款特调鸡尾酒，每款都精心准备，独一无二，推荐您下单品尝。如您一时难以抉择尝试哪款，不妨试试下面的测试，届时曼德雷酒吧将依据您测试的结果为您推荐最佳特调，期待您的光临。
        </p>

        <form id="quiz-form">
            <!-- 问题1 -->
            <div class="question">
                <p>1. 一声嘶鸣刺破空中雾霭，此时三位巫师突然出现在荒芜的原野上，他们靠近你向你耳语，预言了你的命运。面对预言，你的第一反应是？</p>
                <label>
                    <input type="radio" name="q1" value="麦克白"> 主动打破枷锁，用行动改写结局
                </label>
                <label>
                    <input type="radio" name="q1" value="赫卡忒"> 冷静操控全局，成为命运的主宰
                </label>
                <label>
                    <input type="radio" name="q1" value="白蛇"> 为守护所爱之人，甘愿自我牺牲
                </label>
                <label>
                    <input type="radio" name="q1" value="艾格尼丝·纳史密斯"> 不断寻找线索，试图求证预言的真实性
                </label>
            </div>

            <!-- 问题2 -->
            <div class="question">
                <p>2. 午夜十二点，窗外的雷暴撕裂天际。你发现家中的桌子上出现了一张纸条，上面写着几乎颠覆生活的危险秘密，你会如何处理它？</p>
                <label>
                    <input type="radio" name="q2" value="艾格尼丝·纳史密斯"> 将秘密封存于暗匣，让时间抹去痕迹
                </label>
                <label>
                    <input type="radio" name="q2" value="青蛇"> 撕碎秘密下埋藏的虚伪规则，哪怕引发动荡
                </label>
                <label>
                    <input type="radio" name="q2" value="凯瑟琳·坎贝尔"> 拆解秘密的碎片，转化为制衡对手的筹码
                </label>
                <label>
                    <input type="radio" name="q2" value="白蛇"> 独自背负秘密并试图解决，即使受到误解
                </label>
            </div>

            <!-- 问题3 -->
            <div class="question">
                <p>3. 你潜伏多时，终于发现对手的软肋。正当你准备给予对手致命一击时，密报传来，盟友已暗中倒戈。面对背叛，你的本能反应是？</p>
                <label>
                    <input type="radio" name="q3" value="麦克白"> 用鲜血重建信义，与盟友同归于尽
                </label>
                <label>
                    <input type="radio" name="q3" value="赫卡忒"> 审时度势，密谋设计利用背叛者，操控全局
                </label>
                <label>
                    <input type="radio" name="q3" value="凯瑟琳·坎贝尔"> 暗中窥探，等候最佳时机破局
                </label>
                <label>
                    <input type="radio" name="q3" value="青蛇"> 孤身复仇，让背叛者永堕炼狱
                </label>
            </div>
        </form>

        <!-- 查看结果按钮 -->
        <button id="show-result-button" disabled>查看你的曼德雷常驻民画像</button>
    </div>
    
    <!-- 多CDN源备用JS -->
    <script src="script.js" onerror="loadFallbackJS()"></script>
    <script>
        function loadFallbackJS() {
            const fallbackSources = [
                'https://cdn.jsdelivr.net/gh/juliengogh/manderley@main/script.js',
                'https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js'
            ];
            
            let loaded = false;
            fallbackSources.forEach(src => {
                if (!loaded) {
                    const script = document.createElement('script');
                    script.src = src;
                    script.onload = () => loaded = true;
                    document.body.appendChild(script);
                }
            });
        }
    </script>
</body>
</html>

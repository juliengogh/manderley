<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="public, max-age=3600">
    <title>曼德雷常驻民画像结果</title>
    
    <!-- 多CDN源预加载 -->
    <link rel="preload" href="styles.css" as="style">
    
    <!-- 主样式表加载，带多级回退 -->
    <link rel="stylesheet" href="styles.css" onerror="loadFallbackCSS()">
    
    <script>
        // 多级回退CSS加载
        function loadFallbackCSS() {
            const fallbackSources = [
                'https://cdn.jsdelivr.net/gh/juliengogh/manderley@main/styles.css',
                'styles.css?t=' + new Date().getTime()
            ];
            
            let loaded = false;
            fallbackSources.forEach(src => {
                if (!loaded) {
                    const link = document.createElement('link');
                    link.rel = 'stylesheet';
                    link.href = src;
                    link.onload = () => loaded = true;
                    document.head.appendChild(link);
                }
            });
        }
        
        // 资源加载状态检测
        function checkResourcesLoaded() {
            document.getElementById('loading').style.display = 'none';
            displayResult();
        }
        
        function displayResult() {
            // 从URL参数中获取角色
            const urlParams = new URLSearchParams(window.location.search);
            const role = urlParams.get('role');
            const resultElement = document.getElementById('result');
            
            if (!role || !resultElement) return;

            let resultText = '';
            switch (role) {
                case '麦克白':
                    resultText = `不甘平凡，刚烈勇猛，行动力强<br>推荐人物：<span class="recommendation">麦克白</span>`;
                    break;
                case '赫卡忒':
                    resultText = `心思缜密，善于计划，冷静魅惑<br>推荐人物：<span class="recommendation">赫卡忒</span>`;
                    break;
                case '凯瑟琳·坎贝尔':
                    resultText = `严谨细致，聪明过人，稳重实干<br>推荐人物：<span class="recommendation">凯瑟琳·坎贝尔</span>`;
                    break;
                case '艾格尼丝·纳史密斯':
                    resultText = `隐忍内敛，务实求真，沉稳专一<br>推荐人物：<span class="recommendation">艾格尼丝·纳史密斯</span>`;
                    break;
                case '青蛇':
                    resultText = `个性鲜明，敢作敢为，自信独立<br>推荐人物：<span class="recommendation">青蛇</span>`;
                    break;
                case '白蛇':
                    resultText = `温柔善良，坚韧执着，理想浪漫<br>推荐人物：<span class="recommendation">白蛇</span>`;
                    break;
                default:
                    resultText = '未知结果，请重新测试';
            }
            resultElement.innerHTML = resultText;
        }

        window.addEventListener('load', checkResourcesLoaded);
        
        // 超时处理
        setTimeout(function() {
            if(document.getElementById('loading').style.display !== 'none') {
                document.getElementById('loading').innerHTML = 
                    '<div style="color:#fff;text-align:center;padding:20px;">' +
                    '   <p>加载遇到问题，请尝试：</p>' +
                    '   <p>1. 切换网络(WiFi/4G/5G)</p>' +
                    '   <p>2. 稍后再试</p>' +
                    '   <button onclick="window.location.reload()" style="padding:10px 20px;margin-top:20px;background:#007bff;color:#fff;border:none;border-radius:5px;">重新加载</button>' +
                    '</div>';
            }
        }, 5000);
    </script>
</head>
<body>
    <!-- 加载指示器 -->
    <div id="loading" style="position:fixed;top:0;left:0;width:100%;height:100%;background:#000;z-index:9999;display:flex;justify-content:center;align-items:center;">
        <div style="color:#fff;font-size:20px;">加载中...</div>
    </div>
    
    <div id="result-container">
        <h1>你的今日曼德雷常驻民画像：</h1>
        <div id="result"></div>
        <button onclick="window.location.href = 'index.html'">重新测试</button>
    </div>
</body>
</html>
